<%= form_with(model: product, class: "contents") do |form| %>
  <% if product.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-lg mt-3">
      <h2><%= pluralize(product.errors.count, "error") %> prohibi√≥ a este producto de ser guardado:</h2>

      <ul>
        <% product.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="my-5">
    <%= form.label :nombre %>
    <%= form.text_field :name, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full", required: true %>
  </div>

  <div class="my-5">
    <%= form.label :precio %>
    <%= form.number_field :price, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full", required: true, step: :any %>
  </div>

  <div class="my-5 flex flex-col">
    <%= form.label :stock %>
    <% if action_name == "new" %>
      <%= form.number_field :stock, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full", required: true %>
    <% else %>
      <span class="h-10 borderLeft shadow rounded-md border bg-white -border-l border-gray-200 border-r-gray-500 px-3 py-2 mt-2 w-full"><%= @product.stock %></span>
    <%end%>
  </div>

  <%if action_name == "new" %>
    <div class="my-5">
      <%= form.label :category_ids %>
      <%= form.select(:category_ids, @categories, {}, {id: 'categoryselect', multiple: true, required: true, class: "mt-2"}) %>
    </div>
  <% end %>

  <div class="mt-8">
    <% if action_name == "new" %>
      <button class="btn btn-primary" type="submit">Crear Producto</button>
    <% else %>
      <button class="btn btn-primary" type="submit">Actualizar Producto</button>
    <%end%>
  </div>

<%end%>

<script>
  var settings = {
    plugins: {
      'clear_button':{
        'title':'Eliminar todas las opciones seleccionadas',
      },
      remove_button:{
        title:'Remove this item',
      }
    },
    create: true,
    onDelete: function(values) {
      return confirm(values.length > 1 ? 'Are you sure you want to remove these ' + values.length + ' items?' : 'Are you sure you want to remove "' + values[0] + '"?');
    }
  };
  new TomSelect('#categoryselect',settings);
</script>